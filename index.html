<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>Interactive Text â€” audio or definition</title>
<style>
  body { font-family: "Hiragino Kaku Gothic ProN", "Yu Gothic", "Noto Sans JP", sans-serif; }
  body { font-family: system-ui, sans-serif; padding: 20px; line-height:1.6; }
  .word { cursor: pointer; padding: 2px 4px; border-radius: 4px; }
  .word.audio { color: #0066cc; text-decoration: underline; }
  .word.define { color: #ff6600; text-decoration: underline dotted; }
  .word.both { color: #2b7cff; text-decoration: underline; font-weight:600; }
  .word:focus { outline: 3px solid #aaa; }
  .playing { background: rgba(43,124,255,0.08); }
  /* Popup styling */
  .popup { position: fixed; inset: 0; display: none; align-items:center; justify-content:center; background: rgba(0,0,0,0.45); z-index:1000; }
  .popup-content { background: white; max-width: 460px; width: 92%; padding: 18px; border-radius: 10px; box-shadow: 0 8px 30px rgba(0,0,0,0.25); text-align:left; position:relative; }
  .popup img { max-width:100%; height:auto; margin-top:10px; border-radius:6px; display:block; }
  .close-btn { position:absolute; top:8px; right:10px; font-size:20px; cursor:pointer; border:none; background:transparent; }
  .controls { margin-top: 12px; color:#444; font-size:0.95rem; }
#quiz {
  display: flex;
  flex-wrap: wrap;          /* allows wrapping onto new lines */
  justify-content: flex-start;
  gap: 20px;                /* space between question boxes */
  margin-top: 30px;
  padding: 15px;
  background-color: #f9f9f9;
  border-radius: 10px;
  font-family: "Noto Sans JP", "Yu Gothic", sans-serif;
}

.question {
  flex: 1 1 200px;          /* each question box is about 200px wide but flexible */
  min-width: 180px;
  max-width: 250px;
  background: white;
  border: 1px solid #ddd;
  border-radius: 8px;
  padding: 12px;
  text-align: center;
  box-shadow: 0 1px 3px rgba(0,0,0,0.1);
}

.question label {
  font-weight: bold;
  display: block;
  margin-bottom: 6px;
}

.question input {
  width: 80%;
  padding: 5px;
  font-size: 1em;
  margin-bottom: 8px;
}

.question button {
  display: block;           /* puts it below the input */
  width: 100%;
  padding: 6px 10px;
  font-size: 0.9em;
  border-radius: 5px;
  background-color: #e6f0ff;
  border: 1px solid #99bbff;
  cursor: pointer;
}

.question button:hover {
  background-color: #d0e0ff;
}

.question span {
  display: block;
  margin-top: 6px;
  font-weight: bold;
}

#reading-text {
  counter-reset: sentence-counter;
}
.sentence {
  position: relative;
  padding-left: 12px;      /* for the number */
  display: inline;         /* inline instead of inline-block â†’ no gaps */
  counter-increment: sentence-counter;
}

.sentence::before {
  content: counter(sentence-counter);
  font-size: 0.6em;
  color: #555;
  position: absolute;
  left: 0px;
  top: -0.7em;
}

  .mc-question {
  border: 1px solid #ccc;
  padding: 12px;
  margin: 15px 0;
  border-radius: 8px;
  background: #fff;
}

.mc-header {
  display: flex;
  justify-content: space-between;
  align-items: center;
}

.hint-btn {
  font-size: 20px;
  background: none;
  border: none;
  cursor: pointer;
}

.hint-box {
  margin-top: 5px;
  background: #fff9c4;
  padding: 6px;
  border-left: 4px solid #ffeb3b;
  border-radius: 4px;
}

.choices button {
  display: block;
  width: 250px;
  text-align: left;
  margin: 6px 0;
  padding: 6px;
  border-radius: 6px;
}

</style>
</head>
<body>

<h2>ãŠã˜ã</h2>

<div class="instructions">
1. æ¬¡ã®æ–‡ç« ï¼ˆã¶ã‚“ã—ã‚‡ã†ï¼‰ã‚’èª­ã‚“ã§ã€ç©ºæ¬„ï¼ˆãã†ã‚‰ã‚“; blankï¼‰ã«å…¥ã‚‹æ­£ã—ã„ï¼ˆãŸã ã—ã„; correctï¼‰ã‚‚ã®ã‚’å…¨éƒ¨ï¼ˆãœã‚“ã¶; allï¼‰é¸ã‚“ã§ï¼ˆãˆã‚‰ã‚“ã§; chooseï¼‰ãã ã•ã„ã€‚
</div>
  
<p id="reading-text">
  <!-- Examples: specify action + (for audio) data-audio + (for define) data-key -->
<span class="sentence">ãƒŸãƒƒã‚·ã‚§ãƒ«ã¯ã€ä»Šæ—¥æœ¬ã«<span class="word audio" data-action="audio" data-audio="audio/ryuugaku.mp3">ç•™å­¦</span>ã—ã¦ã„ã¾ã™ã€‚</span>
<span class="sentence">ãƒ›ãƒ¼ãƒ ã‚¹ãƒ†ã‚¤ã‚’ã—ã¦ã„ã¦ã€æ¯æ—¥<span class="word audio" data-action="audio" data-audio="audio/densha.mp3">é›»è»Š</span>ã§å¤§å­¦ã«è¡Œã£ã¦ã„ã‚‹ã®ã§ã€æ—¥æœ¬ã®ã„ã‚ã„ã‚ãª<span class="word audio" data-action="audio" data-audio="audio/shyuukan.mp3">ç¿’æ…£</span>ãŒã‚ã‹ã£ã¦ãã¾ã—ãŸã€‚</span>
<span class="sentence">ãƒŸãƒƒã‚·ã‚§ãƒ«ãŒ<span class="word audio" data-action="audio" data-audio="audio/ichiban.mp3">ä¸€ç•ª</span>ãŠã‚‚ã—ã‚ã„ã¨æ€ã†<span class="word audio" data-action="audio" data-audio="audio/shyuukan.mp3">ç¿’æ…£</span>ã¯ã€<span class="word define" data-action="define" data-key="ãŠã˜ã">ãŠã˜ã</span>ã§ã™ã€‚</span>
<span class="sentence"><span class="word audio" data-action="audio" data-audio="audio/kazoku.mp3">å®¶æ—</span>ã©ã†ã—ãŒ<span class="word define" data-action="define" data-key="ãŠã˜ã">ãŠã˜ã</span>ã‚’ã™ã‚‹ã“ã¨ã¯ã‚ã‚Šã¾ã›ã‚“ãŒã€<span class="word define" data-action="define" data-key="ã’ã‚“ã‹ã‚“">ã’ã‚“ã‹ã‚“</span>ã«ãŠ<span class="word audio" data-action="audio" data-audio="audio/kyaku.mp3">å®¢</span>ã•ã‚“ãŒæ¥ãŸã‚‰ã€<span class="word define" data-action="define" data-key="ãŠã˜ã">ãŠã˜ã</span>ã‚’ã—ã¾ã™ã€‚</span>
<span class="sentence"><span class="word audio" data-action="audio" data-audio="audio/soto.mp3">å¤–</span>ã§<span class="word audio" data-action="audio" data-audio="audio/kinjyo.mp3">è¿‘æ‰€</span>ã®äººã«<span class="word audio" data-action="audio" data-audio="audio/atta.mp3">ä¼šã£ãŸ</span>æ™‚ã‚‚<span class="word define" data-action="define" data-key="ãŠã˜ã">ãŠã˜ã</span>ã‚’ã—ã¾ã™ã€‚</span>
<span class="sentence">å¤§å­¦ã®ã‚­ãƒ£ãƒ³ãƒ‘ã‚¹ã§å…ˆç”Ÿã«ä¼šã£ã¦ã€<span class="word define" data-action="define" data-key="ãŠã˜ã">ãŠã˜ã</span>ã‚’ã—ãªã„ã®ã¯ã€ã¨ã¦ã‚‚<span class="word audio" data-action="audio" data-audio="audio/shitsuree.mp3">å¤±ç¤¼</span>ã§ã™ã€‚</span>
<span class="sentence">ã¨ã¦ã‚‚ãŠã‹ã—ã„ã®ã¯ã€<span class="word define" data-action="define" data-key="ã‘ã„ãŸã„é›»è©±">ã‘ã„ãŸã„é›»è©±</span>ã§è©±ã—ã¦ã„ã‚‹äººãŒã€è©±ã—ã¦ã„ã‚‹<span class="word audio" data-action="audio" data-audio="audio/aite.mp3">ç›¸æ‰‹</span>ã«ã€Œã©ã†ã‚‚ã™ã¿ã¾ã›ã‚“ã€ã¨ã‹ã€Œã©ã†ã‚‚ã‚ã‚ŠãŒã¨ã†ã”ã–ã„ã¾ã—ãŸã€ãªã©ã¨è¨€ã£ã¦ã€<span class="word define" data-action="define" data-key="ãŠã˜ã">ãŠã˜ã</span>ã‚’ã™ã‚‹ã“ã¨ã§ã™ã€‚</span>
</p>
<p>
<span class="sentence">ãƒŸãƒƒã‚·ã‚§ãƒ«ã¯ã€ãŠã˜ãã®ã“ã¨ã‚’ã‚‚ã£ã¨ã‚ˆãçŸ¥ã‚ŠãŸã„ã¨æ€ã£ã¦ã€å¤§å­¦ã®<span class="word audio" data-action="audio" data-audio="audio/toshokan.mp3">å›³æ›¸é¤¨</span>ã§æ—¥æœ¬äººã®<span class="word audio" data-action="audio" data-audio="audio/shyuukan.mp3">ç¿’æ…£</span>ã‚’<span class="word audio" data-action="audio" data-audio="audio/setsumee.mp3">èª¬æ˜</span>ã—ã¦ã„ã‚‹æœ¬ã‚’<span class="word audio" data-action="audio" data-audio="audio/karite.mp3">å€Ÿã‚Šã¦</span>ã€ãŠã˜ãã«ã¤ã„ã¦èª­ã‚“ã§ã¿ã¾ã—ãŸã€‚</span>
<span class="sentence">æœ¬ã‚’èª­ã‚“ã§ã€<span class="word audio" data-action="audio" data-audio="audio/tsugi.mp3">æ¬¡</span>ã®ã“ã¨ãŒã‚ã‹ã‚Šã¾ã—ãŸã€‚</span>
<span class="sentence">ã¾ãšã€<span class="word audio" data-action="audio" data-audio="audio/meue.mp3">ç›®ä¸Š</span>ã®äººã¨<span class="word audio" data-action="audio" data-audio="audio/meshita.mp3">ç›®ä¸‹</span>ã®äººãŒ<span class="word audio" data-action="audio" data-audio="audio/atta.mp3">ä¼šã£ãŸ</span>æ™‚ã€<span class="word audio" data-action="audio" data-audio="audio/meshita.mp3">ç›®ä¸‹</span>ã®äººã®ã»ã†ãŒ<span class="word audio" data-action="audio" data-audio="audio/hukai.mp3">æ·±ã„</span>ãŠã˜ãã‚’ã—ãªãã¦ã¯ã„ã‘ã¾ã›ã‚“ã€‚</span>
<span class="sentence">ãŠ<span class="word audio" data-action="audio" data-audio="audio/mise.mp3">åº—</span>ã®<span class="word audio" data-action="audio" data-audio="audio/tenin.mp3">åº—å“¡</span>ã‚„ãƒ¬ã‚¹ãƒˆãƒ©ãƒ³ã®<span class="word define" data-action="define" data-key="ãƒ›ãƒ¼ãƒ«ã‚¹ã‚¿ãƒƒãƒ•">ãƒ›ãƒ¼ãƒ«ã‚¹ã‚¿ãƒƒãƒ•</span>ã‚‚ãŠ<span class="word audio" data-action="audio" data-audio="audio/kyaku.mp3">å®¢</span>ã•ã‚“ã«<span class="word audio" data-action="audio" data-audio="audio/hukai.mp3">æ·±ã„</span>ãŠã˜ãã‚’ã—ãªãã¦ã¯ã„ã‘ã¾ã›ã‚“ã€‚
<span class="sentence">ãã‚Œã‹ã‚‰ã€ãŠã˜ãã¯<span class="word audio" data-action="audio" data-audio="audio/chikaku.mp3">è¿‘ã</span>ã«ã„ã‚‹äººã ã‘ã«ã™ã‚‹ã‚‚ã®ã§ã¯ã‚ã‚Šã¾ã›ã‚“ã€‚</span>
<span class="sentence"><span class="word audio" data-action="audio" data-audio="audio/tooku.mp3">é ã</span>ã«çŸ¥ã£ã¦ã„ã‚‹äººã‚’è¦‹ã¦ã€ãã®äººãŒå‹ã ã¡ã ã£ãŸã‚‰ã€<span class="word define" data-action="define" data-key="æ‰‹ã‚’ãµã‚‹">æ‰‹ã‚’ãµã‚‹</span>ã ã‘ã§ã„ã„ã§ã™ãŒã€ãã®äººãŒ<span class="word audio" data-action="audio" data-audio="audio/meue.mp3">ç›®ä¸Š</span>ã®äººã ã£ãŸã‚‰ã€<span class="word define" data-action="define" data-key="æ‰‹ã‚’ãµã‚‹">æ‰‹ã‚’ãµã‚‹</span>ã®ã§ã¯ãªãã¦ã€<span class="word audio" data-action="audio" data-audio="audio/atama.mp3">é ­</span>ã‚’<span class="word audio" data-action="audio" data-audio="audio/sukoshi.mp3">å°‘ã—</span><span class="word audio" data-action="audio" data-audio="audio/sageta.mp3">ä¸‹ã’ãŸ</span>ã»ã†ãŒã„ã„ã§ã™ã€‚</span>
</p>
<p>
<span class="sentence">ãã®æœ¬ã‚’èª­ã‚“ã§ã‹ã‚‰ã€ãƒŸãƒƒã‚·ã‚§ãƒ«ã¯ã€ãƒ­ãƒ¼ãƒã§ã¯ã€ãƒ­ãƒ¼ãƒäººãŒã™ã‚‹ã‚ˆã†ã«ã—ãªã•ã„ï¼ˆ<span class="word audio" data-action="audio" data-audio="audio/goo.mp3">éƒ·</span>ã«<span class="word audio" data-action="audio" data-audio="audio/itte.mp3">å…¥ã£ã¦</span>ã¯<span class="word audio" data-action="audio" data-audio="audio/goo.mp3">éƒ·</span>ã«ã—ãŸãŒãˆï¼‰When in Rome, do as the Romans do.ã€ã¨ã„ã†<span class="word define" data-action="define" data-key="ã“ã¨ã‚ã–">ã“ã¨ã‚ã–</span>ã‚’<span class="word audio" data-action="audio" data-audio="audio/omoidashite.mp3">æ€ã„å‡ºã—ã¦</span>ã€æ—¥æœ¬äººã®ã‚ˆã†ã«ãŠã˜ãã‚’ã™ã‚‹ã“ã¨ã«ã—ã¾ã—ãŸã€‚</span>
</p>

<div class="controls">
  Use Tab to focus a word and press Enter/Space to activate. Words colored blue = audio, orange = definition, blue+bold = both.
</div>

<!-- Popup for definitions -->
<div class="popup" id="popup" aria-hidden="true">
  <div class="popup-content" role="dialog" aria-modal="true" aria-labelledby="popup-title">
    <button class="close-btn" id="closePopup" aria-label="Close">&times;</button>
    <h2 id="popup-title"></h2>
    <p id="popup-definition"></p>
    <img id="popup-image" src="" alt="" />
  </div>
</div>

<div id="mc-question">
 <div class="mc-question"
     data-hint="ï¼”ã€ï¼•ã€ï¼–ã€ï¼—ã€ï¼‘ï¼’ã€ï¼‘ï¼“æ–‡ç›®ã‚’èª­ã¿ã¾ã—ã‚‡ã†ï¼">

  <div class="mc-header">
    <p class="mc-qtext">1) æ—¥æœ¬äººã¯ã€ï¼¿ï¼¿ï¼¿ï¼¿ï¼¿ï¼¿ï¼¿ã«ãŠã˜ãã‚’ã—ã¾ã›ã‚“ã€‚</p>

    <!-- Light bulb hint button -->
    <button class="hint-btn" onclick="showHint(this)">ğŸ’¡</button>
  </div>

  <div class="hint-box" style="display:none;"></div>

  <div class="choices">

    <button class="mc-option"
            data-option="A"
            data-correct="true">
      A. å®¶æ—
    </button>

    <button class="mc-option"
            data-option="B"
            data-correct="false"
            data-feedback1="âŒã€€ä¸æ­£è§£ï¼ˆãµã›ã„ã‹ã„ï¼‰ - ï¼”æ–‡ç›®ã‚’ã‚‚ã†ä¸€åº¦èª­ã¿ã¾ã—ã‚‡ã†(re-read sentence 4)ï¼"
            data-feedback2="ãƒ’ãƒ³ãƒˆï¼šReview the sentence structures ã€ŒAãŒã€Bã€andã€ŒAãŸã‚‰ã€Bã€."
            data-video="videos/explain1-B.mp4">
      B. ãŠå®¢ã•ã‚“
    </button>

    <button class="mc-option"
            data-option="C"
            data-correct="true">
      C. å‹ã ã¡
    </button>

    <button class="mc-option"
            data-option="D"
            data-correct="false"
            data-feedback1="âŒã€€ä¸æ­£è§£ï¼ˆãµã›ã„ã‹ã„ï¼‰ - ï¼–æ–‡ç›®ã‚’ã‚‚ã†ä¸€åº¦èª­ã¿ã¾ã—ã‚‡ã†(re-read sentence 6)ï¼"
            data-feedback2="ãƒ’ãƒ³ãƒˆï¼šBear in mind the most basic sentence structureã€ŒTopicã¯ã€Commentã§ã™ã€. What is the topic and comment in this sentence?"
            data-video="videos/explain1-D.mp4">
      D. å…ˆç”Ÿ
    </button>

    <button class="mc-option"
            data-option="E"
            data-correct="false"
            data-feedback1="âŒã€€ä¸æ­£è§£ï¼ˆãµã›ã„ã‹ã„ï¼‰ - ï¼—æ–‡ç›®ã‚’ã‚‚ã†ä¸€åº¦èª­ã¿ã¾ã—ã‚‡ã†(re-read sentence 7)ï¼"
            data-feedback2="ãƒ’ãƒ³ãƒˆï¼šWhat is the main sentence within this sentence (ã€ŒTopicã¯ã€Commentã§ã™ã€)? What role does the rest of the sentence play?"
            data-video="videos/explain1-E.mp4">
      E. é›»è©±ã§è©±ã—ã¦ã„ã‚‹ç›¸æ‰‹
    </button>

    <button class="mc-option"
            data-option="F"
            data-correct="false"
            data-feedback1="âŒã€€ä¸æ­£è§£ï¼ˆãµã›ã„ã‹ã„ï¼‰ - ï¼•æ–‡ç›®ã‚’ã‚‚ã†ä¸€åº¦èª­ã¿ã¾ã—ã‚‡ã†(re-read sentence 5)ï¼"
            data-feedback2="ãƒ’ãƒ³ãƒˆï¼šIn the sentence structureã€ŒAæ™‚ã€B (When A, B)ã€, A describes the context in which B occurs."
            data-video="videos/explain1-F.mp4">
      F. è¿‘æ‰€ã®äºº
    </button>

    <button class="mc-option"
            data-option="G"
            data-correct="false"
            data-feedback1="âŒã€€ä¸æ­£è§£ï¼ˆãµã›ã„ã‹ã„ï¼‰ - ï¼‘ï¼“æ–‡ç›®ã‚’ã‚‚ã†ä¸€åº¦èª­ã¿ã¾ã—ã‚‡ã†(re-read sentence 13)ï¼"
            data-feedback2="ãƒ’ãƒ³ãƒˆï¼šReview the sentence structureã€ŒAãŒã€Bã€. In each contrastive situation A and B, there are alsoã€ŒAãŸã‚‰ã€Bã€clauses indicating the context 'When/If A, B'."
            data-video="videos/explain1-G.mp4">
      G. é ãã«ã„ã‚‹äºº
    </button>

    <button class="mc-option"
            data-option="H"
            data-correct="false"
            data-feedback1="âŒã€€ä¸æ­£è§£ï¼ˆãµã›ã„ã‹ã„ï¼‰ - ï¼‘ï¼’æ–‡ç›®ã‚’ã‚‚ã†ä¸€åº¦èª­ã¿ã¾ã—ã‚‡ã†(re-read sentence 12)ï¼"
            data-feedback2="ãƒ’ãƒ³ãƒˆï¼šTry to understand the sentence in the affirmative form firstï¼ˆãŠã˜ãã¯è¿‘ãã«ã„ã‚‹äººã ã‘ã«ã™ã‚‹ã‚‚ã®ã§ã™ï¼‰, then negate it."
            data-video="videos/explain1-H.mp4">
      H. è¿‘ãã«ã„ã‚‹äºº
    </button>
  </div>

  <!-- Result area -->
  <div class="mc-stage1" style="display:none;"></div>

  <!-- Hint stage 1 button -->
  <button class="mc-hint1-btn"
          style="display:none;"
          onclick="showHintStage2(this)">
    ãƒ’ãƒ³ãƒˆï¼‘
  </button>

  <!-- Second feedback stage -->
  <div class="mc-stage2" style="display:none;"></div>

  <!-- Hint stage 2 button -->
  <button class="mc-hint2-btn"
          style="display:none;"
          onclick="showHintStage3(this)">
    ãƒ’ãƒ³ãƒˆï¼’
  </button>

  <!-- Video stage -->
  <div class="mc-stage3" style="display:none;">
    <video class="mc-video" controls style="max-width:100%; margin-top:10px;"></video>
  </div>
</div>

  
 <div class="mc-question"
     data-hint="ï¼˜æ–‡ç›®ã‚’èª­ã¿ã¾ã—ã‚‡ã†ï¼">

  <div class="mc-header">
    <p class="mc-qtext">2) ãƒŸãƒƒã‚·ã‚§ãƒ«ã¯ã€ï¼¿ï¼¿ï¼¿ï¼¿ï¼¿ï¼¿ï¼¿ã‹ã‚‰(reason)ã€ãŠã˜ãã®æœ¬ã‚’èª­ã¿ã¾ã—ãŸã€‚</p>

    <!-- Light bulb hint button -->
    <button class="hint-btn" onclick="showHint(this)">ğŸ’¡</button>
  </div>

  <div class="hint-box" style="display:none;"></div>

  <div class="choices">

    <button class="mc-option"
            data-option="A"
            data-correct="false"
            data-feedback1="âŒã€€ä¸æ­£è§£ï¼ˆãµã›ã„ã‹ã„ï¼‰ - ï¼˜æ–‡ç›®ã‚’ã‚‚ã†ä¸€åº¦èª­ã¿ã¾ã—ã‚‡ã†(re-read sentence 8)ï¼"
            data-feedback2="ãƒ’ãƒ³ãƒˆï¼šGo over the Kanji used in the sentence - is å®¿é¡Œ there?"
            data-video="videos/explain2.mp4">
      A. å®¿é¡Œ
    </button>

    <button class="mc-option"
            data-option="B"
            data-correct="false"
            data-feedback1="âŒã€€ä¸æ­£è§£ï¼ˆãµã›ã„ã‹ã„ï¼‰ - ï¼˜æ–‡ç›®ã‚’ã‚‚ã†ä¸€åº¦èª­ã¿ã¾ã—ã‚‡ã†(re-read sentence 8)ï¼"
            data-feedback2="ãƒ’ãƒ³ãƒˆï¼šDid she borrow the book from a specific person or a place?"
            data-video="videos/explain2.mp4">
      B. å‹ã ã¡ã«æœ¬ã‚’å€Ÿã‚ŠãŸ
    </button>

    <button class="mc-option"
            data-option="C"
            data-correct="true">
      C. ãŠã˜ãã«ã¤ã„ã¦çŸ¥ã‚ŠãŸã„
    </button>
  </div>

  <!-- Result area -->
  <div class="mc-stage1" style="display:none;"></div>

  <!-- Hint stage 1 button -->
  <button class="mc-hint1-btn"
          style="display:none;"
          onclick="showHintStage2(this)">
    ãƒ’ãƒ³ãƒˆï¼‘
  </button>

  <!-- Second feedback stage -->
  <div class="mc-stage2" style="display:none;"></div>

  <!-- Hint stage 2 button -->
  <button class="mc-hint2-btn"
          style="display:none;"
          onclick="showHintStage3(this)">
    ãƒ’ãƒ³ãƒˆï¼’
  </button>

  <!-- Video stage -->
  <div class="mc-stage3" style="display:none;">
    <video class="mc-video" controls style="max-width:100%; margin-top:10px;"></video>
  </div>
</div>

 <div class="mc-question"
     data-hint="ï¼‘ï¼ã€ï¼‘ï¼‘æ–‡ç›®ã‚’èª­ã¿ã¾ã—ã‚‡ã†ï¼">

  <div class="mc-header">
    <p class="mc-qtext">3) ï¼¿ï¼¿ï¼¿ï¼¿ï¼¿ã¯ã€ï¼¿ï¼¿ï¼¿ï¼¿ï¼¿ã«æ·±ã„ãŠã˜ãã‚’ã—ãªãã¦ã¯ã„ã‘ã¾ã›ã‚“ã€‚</p>

    <!-- Light bulb hint button -->
    <button class="hint-btn" onclick="showHint(this)">ğŸ’¡</button>
  </div>

  <div class="hint-box" style="display:none;"></div>

  <div class="choices">

    <button class="mc-option"
            data-option="A"
            data-correct="false"
            data-feedback1="âŒã€€ä¸æ­£è§£ï¼ˆãµã›ã„ã‹ã„ï¼‰ - ï¼‘ï¼æ–‡ç›®ã‚’ã‚‚ã†ä¸€åº¦èª­ã¿ã¾ã—ã‚‡ã†(re-read sentence 10)ï¼"
            data-feedback2="ãƒ’ãƒ³ãƒˆï¼šIn the sentence structureã€ŒAæ™‚ã€B (When A, B)ã€, A describes the context in which B occurs."
            data-video="videos/explain3-A.mp4">
      A. ç›®ä¸Šã®äººã¯ã€€ç›®ä¸‹ã®äººã«
    </button>

    <button class="mc-option"
            data-option="B"
            data-correct="true">
      B. ç›®ä¸‹ã®äººã¯ã€€ç›®ä¸Šã®äººã«
    </button>

    <button class="mc-option"
            data-option="C"
            data-correct="true">
      C. åº—å“¡ã¯ã€€ãŠå®¢ã•ã‚“ã«
    </button>

    <button class="mc-option"
            data-option="D"
            data-correct="false"
            data-feedback1="âŒã€€ä¸æ­£è§£ï¼ˆãµã›ã„ã‹ã„ï¼‰ - ï¼‘ï¼‘æ–‡ç›®ã‚’ã‚‚ã†ä¸€åº¦èª­ã¿ã¾ã—ã‚‡ã†(re-read sentence 11)ï¼"
            data-feedback2="ãƒ’ãƒ³ãƒˆï¼šWhat is the topic of the sentence? Remember that ã‚‚ replaces ã¯ when what follows (i.e., the comment) overlaps with the previous statement (e.g., ç§ã¯ã™ã—ãŒå¥½ãã§ã™ã€‚å…ˆç”Ÿã‚‚ã™ã—ãŒå¥½ãã§ã™ã€‚)"
            data-video="videos/explain3-D.mp4">
      D. ãŠå®¢ã•ã‚“ã¯ã€€åº—å“¡ã«
    </button>

    <button class="mc-option"
            data-option="E"
            data-correct="true">
      E. ãƒ›ãƒ¼ãƒ«ã‚¹ã‚¿ãƒƒãƒ•ã¯ã€€ãŠå®¢ã•ã‚“ã«
    </button>

    <button class="mc-option"
            data-option="F"
            data-correct="false"
            data-feedback1="âŒã€€ä¸æ­£è§£ï¼ˆãµã›ã„ã‹ã„ï¼‰ - ï¼‘ï¼‘æ–‡ç›®ã‚’ã‚‚ã†ä¸€åº¦èª­ã¿ã¾ã—ã‚‡ã†(re-read sentence 11)ï¼"
            data-feedback2="ãƒ’ãƒ³ãƒˆï¼šWhat is the topic of the sentence? Remember that ã‚‚ replaces ã¯ when what follows (i.e., the comment) overlaps with the previous statement (e.g., ç§ã¯ã™ã—ãŒå¥½ãã§ã™ã€‚å…ˆç”Ÿã‚‚ã™ã—ãŒå¥½ãã§ã™ã€‚)"
            data-video="videos/explain3-D.mp4">
      F. ãŠå®¢ã•ã‚“ã¯ã€€ãƒ›ãƒ¼ãƒ«ã‚¹ã‚¿ãƒƒãƒ•ã«
    </button>
  </div>

  <!-- Result area -->
  <div class="mc-stage1" style="display:none;"></div>

  <!-- Hint stage 1 button -->
  <button class="mc-hint1-btn"
          style="display:none;"
          onclick="showHintStage2(this)">
    ãƒ’ãƒ³ãƒˆï¼‘
  </button>

  <!-- Second feedback stage -->
  <div class="mc-stage2" style="display:none;"></div>

  <!-- Hint stage 2 button -->
  <button class="mc-hint2-btn"
          style="display:none;"
          onclick="showHintStage3(this)">
    ãƒ’ãƒ³ãƒˆï¼’
  </button>

  <!-- Video stage -->
  <div class="mc-stage3" style="display:none;">
    <video class="mc-video" controls style="max-width:100%; margin-top:10px;"></video>
  </div>
</div>
  
<div class="instructions">
  2. ä¸‹ã®æ¼¢å­—ã®èª­ã¿æ–¹ã‚’â¬œï¸ã®ä¸­ã«ã²ã‚‰ãŒãªã§æ›¸ã„ã¦ãã ã•ã„ã€‚
</div>

<div id="quiz">

  <div class="question">
    <label>1) ç•™å­¦</label><br>
    <input type="text" id="q1" placeholder="ã²ã‚‰ãŒãªã§å…¥åŠ›"><br>
    <button onclick="checkAnswer('q1', 'ã‚Šã‚…ã†ãŒã')">check answer</button>
    <span id="result-q1"></span>
  </div>

  <div class="question">
    <label>2) é›»è»Š</label><br>
    <input type="text" id="q2" placeholder="ã²ã‚‰ãŒãªã§å…¥åŠ›"><br>
    <button onclick="checkAnswer('q2', 'ã§ã‚“ã—ã‚ƒ')">check answer</button>
    <span id="result-q2"></span>
  </div>

  <div class="question">
    <label>3) ç¿’æ…£</label><br>
    <input type="text" id="q3" placeholder="ã²ã‚‰ãŒãªã§å…¥åŠ›"><br>
    <button onclick="checkAnswer('q3', 'ã—ã‚…ã†ã‹ã‚“')">check answer</button>
    <span id="result-q3"></span>
  </div>

ã€€<div class="question">
    <label>4) ä¸€ç•ª</label><br>
    <input type="text" id="q4" placeholder="ã²ã‚‰ãŒãªã§å…¥åŠ›"><br>
    <button onclick="checkAnswer('q4', 'ã„ã¡ã°ã‚“')">check answer</button>
    <span id="result-q4"></span>
  </div>

ã€€<div class="question">
    <label>5) å®¶æ—</label><br>
    <input type="text" id="q5" placeholder="ã²ã‚‰ãŒãªã§å…¥åŠ›"><br>
    <button onclick="checkAnswer('q5', 'ã‹ãã')">check answer</button>
    <span id="result-q5"></span>
  </div>

ã€€<div class="question">
    <label>6) å®¢</label><br>
    <input type="text" id="q6" placeholder="ã²ã‚‰ãŒãªã§å…¥åŠ›"><br>
    <button onclick="checkAnswer('q6', 'ãã‚ƒã')">check answer</button>
    <span id="result-q6"></span>
  </div>

ã€€<div class="question">
    <label>7) å¤–</label><br>
    <input type="text" id="q7" placeholder="ã²ã‚‰ãŒãªã§å…¥åŠ›"><br>
    <button onclick="checkAnswer('q7', 'ãã¨')">check answer</button>
    <span id="result-q7"></span>
  </div>

ã€€<div class="question">
    <label>8) è¿‘æ‰€</label><br>
    <input type="text" id="q8" placeholder="ã²ã‚‰ãŒãªã§å…¥åŠ›"><br>
    <button onclick="checkAnswer('q8', 'ãã‚“ã˜ã‚‡')">check answer</button>
    <span id="result-q8"></span>
  </div>

ã€€<div class="question">
    <label>9) ä¼šã†</label><br>
    <input type="text" id="q9" placeholder="ã²ã‚‰ãŒãªã§å…¥åŠ›"><br>
    <button onclick="checkAnswer('q9', 'ã‚ã†')">check answer</button>
    <span id="result-q9"></span>
  </div>

ã€€<div class="question">
    <label>10) å¤±ç¤¼</label><br>
    <input type="text" id="q10" placeholder="ã²ã‚‰ãŒãªã§å…¥åŠ›"><br>
    <button onclick="checkAnswer('q10', 'ã—ã¤ã‚Œã„')">check answer</button>
    <span id="result-q10"></span>
  </div>

ã€€<div class="question">
    <label>11) é›»è©±</label><br>
    <input type="text" id="q11" placeholder="ã²ã‚‰ãŒãªã§å…¥åŠ›"><br>
    <button onclick="checkAnswer('q11', 'ã§ã‚“ã‚')">check answer</button>
    <span id="result-q11"></span>
  </div>

ã€€<div class="question">
    <label>12) è©±ã™</label><br>
    <input type="text" id="q12" placeholder="ã²ã‚‰ãŒãªã§å…¥åŠ›"><br>
    <button onclick="checkAnswer('q12', 'ã¯ãªã™')">check answer</button>
    <span id="result-q12"></span>
  </div>

ã€€<div class="question">
    <label>13) çŸ¥ã‚‹</label><br>
    <input type="text" id="q13" placeholder="ã²ã‚‰ãŒãªã§å…¥åŠ›"><br>
    <button onclick="checkAnswer('q13', 'ã—ã‚‹')">check answer</button>
    <span id="result-q13"></span>
  </div>

ã€€<div class="question">
    <label>14) å›³æ›¸é¤¨</label><br>
    <input type="text" id="q14" placeholder="ã²ã‚‰ãŒãªã§å…¥åŠ›"><br>
    <button onclick="checkAnswer('q14', 'ã¨ã—ã‚‡ã‹ã‚“')">check answer</button>
    <span id="result-q14"></span>
  </div>

ã€€<div class="question">
    <label>15) èª¬æ˜</label><br>
    <input type="text" id="q15" placeholder="ã²ã‚‰ãŒãªã§å…¥åŠ›"><br>
    <button onclick="checkAnswer('q15', 'ã›ã¤ã‚ã„')">check answer</button>
    <span id="result-q15"></span>
  </div>

ã€€<div class="question">
    <label>16) å€Ÿã‚Šã‚‹</label><br>
    <input type="text" id="q16" placeholder="ã²ã‚‰ãŒãªã§å…¥åŠ›"><br>
    <button onclick="checkAnswer('q16', 'ã‹ã‚Šã‚‹')">check answer</button>
    <span id="result-q16"></span>
  </div>

ã€€<div class="question">
    <label>17) èª­ã‚€</label><br>
    <input type="text" id="q17" placeholder="ã²ã‚‰ãŒãªã§å…¥åŠ›"><br>
    <button onclick="checkAnswer('q17', 'ã‚ˆã‚€')">check answer</button>
    <span id="result-q17"></span>
  </div>

ã€€<div class="question">
    <label>18) æ¬¡</label><br>
    <input type="text" id="q18" placeholder="ã²ã‚‰ãŒãªã§å…¥åŠ›"><br>
    <button onclick="checkAnswer('q18', 'ã¤ã')">check answer</button>
    <span id="result-q18"></span>
  </div>

ã€€<div class="question">
    <label>19) ç›®ä¸Š</label><br>
    <input type="text" id="q19" placeholder="ã²ã‚‰ãŒãªã§å…¥åŠ›"><br>
    <button onclick="checkAnswer('q19', 'ã‚ã†ãˆ')">check answer</button>
    <span id="result-q19"></span>
  </div>

ã€€<div class="question">
    <label>20) ç›®ä¸‹</label><br>
    <input type="text" id="q20" placeholder="ã²ã‚‰ãŒãªã§å…¥åŠ›"><br>
    <button onclick="checkAnswer('q20', 'ã‚ã—ãŸ')">check answer</button>
    <span id="result-q20"></span>
  </div>

ã€€<div class="question">
    <label>21) æ·±ã„</label><br>
    <input type="text" id="q21" placeholder="ã²ã‚‰ãŒãªã§å…¥åŠ›"><br>
    <button onclick="checkAnswer('q21', 'ãµã‹ã„')">check answer</button>
    <span id="result-q21"></span>
  </div>

ã€€ã€€<div class="question">
    <label>22) è¿‘ã„</label><br>
    <input type="text" id="q22" placeholder="ã²ã‚‰ãŒãªã§å…¥åŠ›"><br>
    <button onclick="checkAnswer('q22', 'ã¡ã‹ã„')">check answer</button>
    <span id="result-q22"></span>
  </div>

ã€€ã€€<div class="question">
    <label>23) é ã„</label><br>
    <input type="text" id="q23" placeholder="ã²ã‚‰ãŒãªã§å…¥åŠ›"><br>
    <button onclick="checkAnswer('q23', 'ã¨ãŠã„')">check answer</button>
    <span id="result-q23"></span>
  </div>

ã€€ã€€<div class="question">
    <label>24) é ­</label><br>
    <input type="text" id="q24" placeholder="ã²ã‚‰ãŒãªã§å…¥åŠ›"><br>
    <button onclick="checkAnswer('q24', 'ã‚ãŸã¾')">check answer</button>
    <span id="result-q24"></span>
  </div>

ã€€ã€€<div class="question">
    <label>25) å°‘ã—</label><br>
    <input type="text" id="q25" placeholder="ã²ã‚‰ãŒãªã§å…¥åŠ›"><br>
    <button onclick="checkAnswer('q25', 'ã™ã“ã—')">check answer</button>
    <span id="result-q25"></span>
  </div>

ã€€ã€€<div class="question">
    <label>26) ä¸‹ã’ã‚‹</label><br>
    <input type="text" id="q26" placeholder="ã²ã‚‰ãŒãªã§å…¥åŠ›"><br>
    <button onclick="checkAnswer('q26', 'ã•ã’ã‚‹')">check answer</button>
    <span id="result-q26"></span>
  </div>

ã€€ã€€<div class="question">
    <label>27) æ€ã„å‡ºã™</label><br>
    <input type="text" id="q27" placeholder="ã²ã‚‰ãŒãªã§å…¥åŠ›"><br>
    <button onclick="checkAnswer('q27', 'ãŠã‚‚ã„ã ã™')">check answer</button>
    <span id="result-q27"></span>
  </div>

   <div class="question">
    <label>28) ç›¸æ‰‹</label><br>
    <input type="text" id="q28" placeholder="ã²ã‚‰ãŒãªã§å…¥åŠ›"><br>
    <button onclick="checkAnswer('q28', 'ã‚ã„ã¦')">check answer</button>
    <span id="result-q28"></span>
  </div>
</div>

<script>
function showHint(btn) {
  const q = btn.closest(".mc-question");
  const hintBox = q.querySelector(".hint-box");
  hintBox.textContent = q.dataset.hint;
  hintBox.style.display = "block";
}

function checkMCOption(optionBtn) {
  const q = optionBtn.closest(".mc-question");

  const isCorrect = optionBtn.dataset.correct === "true";
  const feedback1 = optionBtn.dataset.feedback1;
  const feedback2 = optionBtn.dataset.feedback2;
  const videoPath = optionBtn.dataset.video;

  const stage1 = q.querySelector(".mc-stage1");
  const stage2 = q.querySelector(".mc-stage2");
  const stage3 = q.querySelector(".mc-stage3");

  const hint1Btn = q.querySelector(".mc-hint1-btn");
  const hint2Btn = q.querySelector(".mc-hint2-btn");
  const videoEl = q.querySelector(".mc-video");

  // Reset stages
  stage1.style.display = "none";
  stage2.style.display = "none";
  stage3.style.display = "none";
  hint1Btn.style.display = "none";
  hint2Btn.style.display = "none";

  if (isCorrect) {
    stage1.textContent = "âœ… æ­£è§£ï¼ˆã›ã„ã‹ã„ï¼‰";
    stage1.style.color = "green";
    stage1.style.display = "block";
    return;
  }

  // Incorrect option â†’ Stage 1 feedback
  stage1.textContent = feedback1;
  stage1.style.color = "red";
  stage1.style.display = "block";

  // Show hint1 button
  hint1Btn.dataset.feedback2 = feedback2;
  hint1Btn.dataset.video = videoPath;
  hint1Btn.style.display = "inline-block";
}

function showHintStage2(btn) {
  const q = btn.closest(".mc-question");
  const stage2 = q.querySelector(".mc-stage2");

  stage2.textContent = btn.dataset.feedback2;
  stage2.style.display = "block";

  // Set up hint 2 button for stage 3
  const hint2Btn = q.querySelector(".mc-hint2-btn");
  hint2Btn.dataset.video = btn.dataset.video;
  hint2Btn.style.display = "inline-block";
}

function showHintStage3(btn) {
  const q = btn.closest(".mc-question");
  const stage3 = q.querySelector(".mc-stage3");
  const videoEl = q.querySelector(".mc-video");

  videoEl.src = btn.dataset.video;
  stage3.style.display = "block";
}

// Allow all options to trigger checkMCOption
document.addEventListener("click", function(e) {
  if (e.target.classList.contains("mc-option")) {
    checkMCOption(e.target);
  }
});

function checkAnswer(inputId, correctAnswer) {
  const userInput = document.getElementById(inputId).value.trim();
  const resultSpan = document.getElementById("result-" + inputId);

  if (userInput === correctAnswer) {
    resultSpan.textContent = "âœ… æ­£è§£ï¼ˆã›ã„ã‹ã„ï¼‰ï¼(Correct!)";
    resultSpan.style.color = "green";
  } else {
    resultSpan.textContent = `âŒ ä¸æ­£è§£ï¼ˆãµã›ã„ã‹ã„ï¼‰(Incorrect): æ­£ã—ã„ç­”ãˆã¯ã€Œ${correctAnswer}ã€ã§ã™ã€‚`;
    resultSpan.style.color = "red";
  }
}
</script>

<script>
/* ---------- Data: definitions + image paths ---------- */
/* Add entries for words you want definitions for. Key should match data-key on <span>. */
const dictionary = {
  "ãŠã˜ã": {
    word: "ãŠã˜ã",
    definition: "Bowing.",
    image: "images/ojigi.jpg"
  },
  "ã‘ã„ãŸã„é›»è©±": {
    word: "ã‘ã„ãŸã„é›»è©±",
    definition: "Cell phone.",
    image: "images/denwa.jpg"
  },
  "ã“ã¨ã‚ã–": {
    word: "ã“ã¨ã‚ã–",
    definition: "Proverb.",
    image: "images/kotowaza.jpg"
  },
   "ãƒ›ãƒ¼ãƒ«ã‚¹ã‚¿ãƒƒãƒ•": {
    word: "ãƒ›ãƒ¼ãƒ«ã‚¹ã‚¿ãƒƒãƒ•",
    definition: "Waiting staff.",
    image: "images/staff.jpg"
  },
  "æ‰‹ã‚’ãµã‚‹": {
    word: "æ‰‹ã‚’ãµã‚‹",
    definition: "To wave.",
    image: "images/teohuru.jpg"
  },
  "ã’ã‚“ã‹ã‚“": {
    word: "ã’ã‚“ã‹ã‚“",
    definition: "Front door.",
    image: "images/genkan.jpg"
  }
};
/* ---------------------------------------------------- */

/* Utility: Stop all playing audio and remove playing highlight */
function stopAllPlaying() {
  document.querySelectorAll('.word.playing').forEach(el => el.classList.remove('playing'));
  // Pause any audio objects stored on elements
  document.querySelectorAll('.word').forEach(el => {
    if (el._audio) {
      try { el._audio.pause(); el._audio.currentTime = 0; } catch(e) {}
    }
  });
}

/* Handle popup (definition + image) */
const popup = document.getElementById('popup');
const popupTitle = document.getElementById('popup-title');
const popupDefinition = document.getElementById('popup-definition');
const popupImage = document.getElementById('popup-image');
const closePopup = document.getElementById('closePopup');

function showPopup(key) {
  const entry = dictionary[key];
  if (!entry) return;
  popupTitle.textContent = entry.word;
  popupDefinition.textContent = entry.definition;
  popupImage.src = entry.image || "";
  popupImage.alt = entry.image ? `Image illustrating ${entry.word}` : "";
  popup.style.display = 'flex';
  popup.setAttribute('aria-hidden', 'false');
  // trap focus to close button for simple accessibility
  closePopup.focus();
}
function hidePopup() {
  popup.style.display = 'none';
  popup.setAttribute('aria-hidden', 'true');
}

/* Close handlers */
closePopup.addEventListener('click', hidePopup);
popup.addEventListener('click', (e) => {
  if (e.target === popup) hidePopup(); // click outside content
});
document.addEventListener('keydown', (e) => {
  if (e.key === 'Escape') hidePopup();
});

/* Main: wire up word elements */
document.querySelectorAll('.word').forEach(elem => {
  const action = elem.dataset.action || "";
  // Preload audio only if audio provided
  if ((action === 'audio' || action === 'both') && elem.dataset.audio) {
    const a = new Audio(elem.dataset.audio);
    elem._audio = a;
  }

  function activate() {
    const a = elem._audio;
    const key = (elem.dataset.key || "").toLowerCase();

    // If both or audio -> play audio
    if ((action === 'audio' || action === 'both') && a) {
      stopAllPlaying();
      elem.classList.add('playing');
      a.currentTime = 0;
      a.play().catch(err => { console.warn("audio play failed:", err); });
      a.onended = () => elem.classList.remove('playing');
    }

    // If define or both -> show popup if entry exists; else optional fallback
    if ((action === 'define' || action === 'both') && key) {
      if (dictionary[key]) {
        showPopup(key);
      } else {
        // Fallback: try browser TTS to read a short message
        const msg = `${key}. Definition not available.`;
        if ('speechSynthesis' in window) {
          speechSynthesis.cancel();
          const ut = new SpeechSynthesisUtterance(msg);
          speechSynthesis.speak(ut);
        } else {
          alert(msg);
        }
      }
    }
  }

  // click handler
  elem.addEventListener('click', activate);

  // keyboard activation (Enter or Space)
  elem.addEventListener('keydown', (e) => {
    if (e.key === 'Enter' || e.key === ' ') {
      e.preventDefault();
      activate();
    }
  });
});

/* Accessibility: ensure focus outline on click for mouse users */
document.addEventListener('mousedown', () => {
  document.body.classList.add('using-mouse');
});
document.addEventListener('keydown', () => {
  document.body.classList.remove('using-mouse');
});
</script>
</body>
</html>
